#  –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ä–∞–±–æ—á–∞—è –±–ª–æ–∫—á–µ–π–Ω —Å–µ—Ç—å –Ω–∞ Python!
## üìö –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

### 1. –ö–ª–∞—Å—Å Block (–ë–ª–æ–∫)

* –°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω–¥–µ–∫—Å, –≤—Ä–µ–º—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, proof –∏ —Ö–µ—à –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–ª–æ–∫–∞
* –ú–µ—Ç–æ–¥ compute_hash() - –≤—ã—á–∏—Å–ª—è–µ—Ç SHA-256 —Ö–µ—à –±–ª–æ–∫–∞

### 2. –ö–ª–∞—Å—Å Blockchain (–û—Å–Ω–æ–≤–Ω–æ–π)

* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
* Proof of Work - –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞–π–Ω–∏–Ω–≥–∞ (–∏—â–µ—Ç —Ö–µ—à —Å 4 –Ω—É–ª—è–º–∏ –≤ –Ω–∞—á–∞–ª–µ)
* –í–∞–ª–∏–¥–∞—Ü–∏—è - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ü–µ–ø–∏
* –ö–æ–Ω—Å–µ–Ω—Å—É—Å - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏
* –ë–∞–ª–∞–Ω—Å—ã - –ø–æ–¥—Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–∞ –∞–¥—Ä–µ—Å–æ–≤

### 3. Flask API (–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

* GET /mine - –º–∞–π–Ω–∏–Ω–≥ –±–ª–æ–∫–∞
* POST /transactions/new - —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
* GET /chain - –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–ø—å
* POST /nodes/register - –¥–æ–±–∞–≤–∏—Ç—å —É–∑–ª—ã
* GET /nodes/resolve - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å
* GET /balance/<address> - –±–∞–ª–∞–Ω—Å –∞–¥—Ä–µ—Å–∞

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
````
python blockchain.py demo
````
–ó–∞–ø—É—Å–∫ —É–∑–ª–∞ —Å–µ—Ç–∏:
````
# –£–∑–µ–ª 1 –Ω–∞ –ø–æ—Ä—Ç—É 5000
python blockchain.py 5000

# –£–∑–µ–ª 2 –Ω–∞ –ø–æ—Ä—Ç—É 5001
python blockchain.py 5001

# –£–∑–µ–ª 3 –Ω–∞ –ø–æ—Ä—Ç—É 5002
python blockchain.py 5002
````
## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API:

### 1. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é:
````bash
curl -X POST http://localhost:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Alice","recipient":"Bob","amount":5.0}'
````

### 2. –ú–∞–π–Ω–∏–Ω–≥ –±–ª–æ–∫–∞:
````bash
curl http://localhost:5000/mine
````

### 3. –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–ø—å:
````bash
curl http://localhost:5000/chain
````

### 4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É–∑–ª—ã:
````bash
curl -X POST http://localhost:5000/nodes/register \
  -H "Content-Type: application/json" \
  -d '{"nodes":["http://localhost:5001","http://localhost:5002"]}'
````

### 5. –ö–æ–Ω—Å–µ–Ω—Å—É—Å (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è):
````bash
curl http://localhost:5000/nodes/resolve
````

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å:
````bash
curl http://localhost:5000/balance/Alice
````
## üîê –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

* Proof of Work - –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
* –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∞ –ª–æ–º–∞–µ—Ç –≤—Å—é —Ü–µ–ø—å
* –ö–æ–Ω—Å–µ–Ω—Å—É—Å - —Å–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è –≤–∞–ª–∏–¥–Ω–∞—è —Ü–µ–ø—å –ø–æ–±–µ–∂–¥–∞–µ—Ç
* –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è - –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª–Ω—É—é –∫–æ–ø–∏—é
````python
import hashlib
import json
import time
from typing import List, Dict, Optional
from datetime import datetime
import requests
from urllib.parse import urlparse
from flask import Flask, jsonify, request


# ============================================
# –ë–õ–û–ö - –æ—Å–Ω–æ–≤–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –±–ª–æ–∫—á–µ–π–Ω–∞
# ============================================
class Block:
    """
    –ë–ª–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç:
    - index: –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞
    - timestamp: –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
    - transactions: —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
    - proof: proof of work (nonce)
    - previous_hash: —Ö–µ—à –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–ª–æ–∫–∞
    """
    def __init__(self, index: int, timestamp: float, transactions: List[Dict], 
                 proof: int, previous_hash: str):
        self.index = index
        self.timestamp = timestamp
        self.transactions = transactions
        self.proof = proof
        self.previous_hash = previous_hash
    
    def compute_hash(self) -> str:
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç SHA-256 —Ö–µ—à –±–ª–æ–∫–∞
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –±–ª–æ–∫–æ–≤ –≤ —Ü–µ–ø—å
        """
        block_string = json.dumps(self.__dict__, sort_keys=True)
        return hashlib.sha256(block_string.encode()).hexdigest()
    
    def to_dict(self) -> Dict:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –±–ª–æ–∫ –≤ —Å–ª–æ–≤–∞—Ä—å –¥–ª—è JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏"""
        return {
            'index': self.index,
            'timestamp': self.timestamp,
            'transactions': self.transactions,
            'proof': proof,
            'previous_hash': self.previous_hash
        }


# ============================================
# BLOCKCHAIN - –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ü–µ–ø–∏ –±–ª–æ–∫–æ–≤
# ============================================
class Blockchain:
    """
    –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –±–ª–æ–∫—á–µ–π–Ω–∞
    –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ü–µ–ø—å—é –±–ª–æ–∫–æ–≤, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–æ–º
    """
    
    def __init__(self):
        self.chain: List[Block] = []
        self.current_transactions: List[Dict] = []
        self.nodes: set = set()  # –£–∑–ª—ã —Å–µ—Ç–∏
        
        # –°–æ–∑–¥–∞—ë–º genesis –±–ª–æ–∫ (–ø–µ—Ä–≤—ã–π –±–ª–æ–∫)
        self.create_genesis_block()
    
    def create_genesis_block(self):
        """
        Genesis –±–ª–æ–∫ - –ø–µ—Ä–≤—ã–π –±–ª–æ–∫ –≤ —Ü–µ–ø–∏
        –ù–µ –∏–º–µ–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–ª–æ–∫–∞, –ø–æ—ç—Ç–æ–º—É previous_hash = "0"
        """
        genesis_block = Block(
            index=0,
            timestamp=time.time(),
            transactions=[],
            proof=100,  # –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            previous_hash="0"
        )
        self.chain.append(genesis_block)
        print("üéâ Genesis –±–ª–æ–∫ —Å–æ–∑–¥–∞–Ω!")
    
    def get_last_block(self) -> Block:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–ª–æ–∫ –≤ —Ü–µ–ø–∏"""
        return self.chain[-1]
    
    # ============================================
    # –¢–†–ê–ù–ó–ê–ö–¶–ò–ò
    # ============================================
    
    def new_transaction(self, sender: str, recipient: str, amount: float) -> int:
        """
        –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        
        Args:
            sender: –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
            recipient: –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
            amount: —Å—É–º–º–∞
        
        Returns:
            index –±–ª–æ–∫–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
        """
        transaction = {
            'sender': sender,
            'recipient': recipient,
            'amount': amount,
            'timestamp': time.time()
        }
        
        self.current_transactions.append(transaction)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–ª–æ–∫–∞
        return self.get_last_block().index + 1
    
    # ============================================
    # PROOF OF WORK - –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
    # ============================================
    
    def proof_of_work(self, last_proof: int) -> int:
        """
        –ü—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º Proof of Work:
        - –ù–∞–π—Ç–∏ —á–∏—Å–ª–æ p', —Ç–∞–∫–æ–µ —á—Ç–æ hash(pp') —Å–æ–¥–µ—Ä–∂–∏—Ç 4 –Ω—É–ª—è –≤ –Ω–∞—á–∞–ª–µ
        - p - –ø—Ä–µ–¥—ã–¥—É—â–∏–π proof, p' - –Ω–æ–≤—ã–π proof
        
        –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–∞
        """
        proof = 0
        while not self.valid_proof(last_proof, proof):
            proof += 1
        
        print(f"‚õèÔ∏è  –ú–∞–π–Ω–∏–Ω–≥ –∑–∞–≤–µ—Ä—à—ë–Ω! –ù–∞–π–¥–µ–Ω proof: {proof}")
        return proof
    
    @staticmethod
    def valid_proof(last_proof: int, proof: int, difficulty: int = 4) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç proof: hash(last_proof, proof) –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å N –Ω—É–ª–µ–π?
        
        Args:
            last_proof: –ø—Ä–µ–¥—ã–¥—É—â–∏–π proof
            proof: —Ç–µ–∫—É—â–∏–π proof
            difficulty: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω—É–ª–µ–π –≤ –Ω–∞—á–∞–ª–µ (—Å–ª–æ–∂–Ω–æ—Å—Ç—å)
        """
        guess = f'{last_proof}{proof}'.encode()
        guess_hash = hashlib.sha256(guess).hexdigest()
        return guess_hash[:difficulty] == "0" * difficulty
    
    # ============================================
    # –°–û–ó–î–ê–ù–ò–ï –ù–û–í–´–• –ë–õ–û–ö–û–í
    # ============================================
    
    def mine_block(self, miner_address: str) -> Block:
        """
        –ú–∞–π–Ω–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞:
        1. –í—ã—á–∏—Å–ª—è–µ–º proof of work
        2. –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ –º–∞–π–Ω–µ—Ä—É
        3. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –±–ª–æ–∫
        4. –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ü–µ–ø—å
        """
        last_block = self.get_last_block()
        last_proof = last_block.proof
        
        # –í—ã—á–∏—Å–ª—è–µ–º proof of work (—ç—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è!)
        print("‚õèÔ∏è  –ù–∞—á–∏–Ω–∞–µ–º –º–∞–π–Ω–∏–Ω–≥...")
        proof = self.proof_of_work(last_proof)
        
        # –ù–∞–≥—Ä–∞–¥–∞ –º–∞–π–Ω–µ—Ä—É (–æ—Ç "—Å–∏—Å—Ç–µ–º—ã")
        self.new_transaction(
            sender="0",  # 0 –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–æ–≤—ã–µ –º–æ–Ω–µ—Ç—ã
            recipient=miner_address,
            amount=1.0  # –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –±–ª–æ–∫
        )
        
        # –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –±–ª–æ–∫
        previous_hash = last_block.compute_hash()
        new_block = Block(
            index=len(self.chain),
            timestamp=time.time(),
            transactions=self.current_transactions,
            proof=proof,
            previous_hash=previous_hash
        )
        
        # –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        self.current_transactions = []
        
        # –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ –≤ —Ü–µ–ø—å
        self.chain.append(new_block)
        
        print(f"‚úÖ –ë–ª–æ–∫ #{new_block.index} –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ü–µ–ø—å!")
        return new_block
    
    # ============================================
    # –í–ê–õ–ò–î–ê–¶–ò–Ø –¶–ï–ü–ò
    # ============================================
    
    def is_valid_chain(self, chain: List[Block]) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ü–µ–ø–∏:
        1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ö–µ—à–∏ –±–ª–æ–∫–æ–≤
        2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç proof of work
        """
        previous_block = chain[0]
        current_index = 1
        
        while current_index < len(chain):
            block = chain[current_index]
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –•–µ—à –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–ª–æ–∫–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç?
            if block.previous_hash != previous_block.compute_hash():
                print(f"‚ùå –¶–µ–ø—å –Ω–µ–≤–∞–ª–∏–¥–Ω–∞: —Ö–µ—à –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç –Ω–∞ –±–ª–æ–∫–µ {current_index}")
                return False
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: Proof of work –≤–∞–ª–∏–¥–µ–Ω?
            if not self.valid_proof(previous_block.proof, block.proof):
                print(f"‚ùå –¶–µ–ø—å –Ω–µ–≤–∞–ª–∏–¥–Ω–∞: proof –Ω–µ–≤–µ—Ä–µ–Ω –Ω–∞ –±–ª–æ–∫–µ {current_index}")
                return False
            
            previous_block = block
            current_index += 1
        
        return True
    
    # ============================================
    # –ö–û–ù–°–ï–ù–°–£–° - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
    # ============================================
    
    def register_node(self, address: str):
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π —É–∑–µ–ª –≤ —Å–µ—Ç—å
        
        Args:
            address: –∞–¥—Ä–µ—Å —É–∑–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä 'http://192.168.0.5:5000'
        """
        parsed_url = urlparse(address)
        self.nodes.add(parsed_url.netloc)
        print(f"üîó –£–∑–µ–ª {parsed_url.netloc} –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–µ—Ç—å")
    
    def resolve_conflicts(self) -> bool:
        """
        –ê–ª–≥–æ—Ä–∏—Ç–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞:
        –ó–∞–º–µ–Ω—è–µ—Ç –Ω–∞—à—É —Ü–µ–ø—å —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –≤–∞–ª–∏–¥–Ω–æ–π —Ü–µ–ø—å—é –≤ —Å–µ—Ç–∏
        
        Returns:
            True –µ—Å–ª–∏ —Ü–µ–ø—å –±—ã–ª–∞ –∑–∞–º–µ–Ω–µ–Ω–∞, False –µ—Å–ª–∏ –Ω–µ—Ç
        """
        neighbours = self.nodes
        new_chain = None
        
        # –ò—â–µ–º —Ü–µ–ø–∏ –¥–ª–∏–Ω–Ω–µ–µ –Ω–∞—à–µ–π
        max_length = len(self.chain)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —É–∑–ª—ã –≤ —Å–µ—Ç–∏
        for node in neighbours:
            try:
                response = requests.get(f'http://{node}/chain')
                
                if response.status_code == 200:
                    length = response.json()['length']
                    chain_data = response.json()['chain']
                    
                    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º JSON –≤ –æ–±—ä–µ–∫—Ç—ã Block
                    chain = []
                    for block_data in chain_data:
                        block = Block(
                            index=block_data['index'],
                            timestamp=block_data['timestamp'],
                            transactions=block_data['transactions'],
                            proof=block_data['proof'],
                            previous_hash=block_data['previous_hash']
                        )
                        chain.append(block)
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º: —Ü–µ–ø—å –¥–ª–∏–Ω–Ω–µ–µ –∏ –≤–∞–ª–∏–¥–Ω–∞?
                    if length > max_length and self.is_valid_chain(chain):
                        max_length = length
                        new_chain = chain
            except:
                continue
        
        # –ó–∞–º–µ–Ω—è–µ–º —Ü–µ–ø—å –µ—Å–ª–∏ –Ω–∞—à–ª–∏ –ª—É—á—à—É—é
        if new_chain:
            self.chain = new_chain
            print("üîÑ –¶–µ–ø—å –∑–∞–º–µ–Ω–µ–Ω–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π!")
            return True
        
        print("‚úÖ –ù–∞—à–∞ —Ü–µ–ø—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∞")
        return False
    
    # ============================================
    # –ü–û–õ–£–ß–ï–ù–ò–ï –ë–ê–õ–ê–ù–°–ê
    # ============================================
    
    def get_balance(self, address: str) -> float:
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å –∞–¥—Ä–µ—Å–∞ –ø—É—Ç—ë–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π —Ü–µ–ø–∏
        """
        balance = 0.0
        
        for block in self.chain:
            for transaction in block.transactions:
                if transaction['recipient'] == address:
                    balance += transaction['amount']
                if transaction['sender'] == address:
                    balance -= transaction['amount']
        
        return balance
    
    # ============================================
    # –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´
    # ============================================
    
    def to_dict(self) -> Dict:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å—é —Ü–µ–ø—å –≤ —Å–ª–æ–≤–∞—Ä—å"""
        chain_data = []
        for block in self.chain:
            chain_data.append({
                'index': block.index,
                'timestamp': block.timestamp,
                'transactions': block.transactions,
                'proof': block.proof,
                'previous_hash': block.previous_hash,
                'hash': block.compute_hash()
            })
        return chain_data
    
    def print_chain(self):
        """–ö—Ä–∞—Å–∏–≤–æ –≤—ã–≤–æ–¥–∏—Ç –≤—Å—é —Ü–µ–ø—å"""
        print("\n" + "="*60)
        print("üìä BLOCKCHAIN")
        print("="*60)
        
        for block in self.chain:
            print(f"\nüîó –ë–ª–æ–∫ #{block.index}")
            print(f"   –í—Ä–µ–º—è: {datetime.fromtimestamp(block.timestamp)}")
            print(f"   –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: {len(block.transactions)}")
            print(f"   Proof: {block.proof}")
            print(f"   –ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ö–µ—à: {block.previous_hash[:16]}...")
            print(f"   –•–µ—à: {block.compute_hash()[:16]}...")
            
            if block.transactions:
                print("   –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:")
                for tx in block.transactions:
                    print(f"      {tx['sender'][:8]} ‚Üí {tx['recipient'][:8]}: {tx['amount']} BTC")
        
        print("\n" + "="*60 + "\n")


# ============================================
# FLASK API - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±–ª–æ–∫—á–µ–π–Ω–∞
# ============================================

# –°–æ–∑–¥–∞—ë–º Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
app = Flask(__name__)

# –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –¥–ª—è —ç—Ç–æ–≥–æ —É–∑–ª–∞
import uuid
node_identifier = str(uuid.uuid4()).replace('-', '')

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–ª–æ–∫—á–µ–π–Ω
blockchain = Blockchain()


@app.route('/mine', methods=['GET'])
def mine():
    """–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–∞ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞"""
    # –ú–∞–π–Ω–∏–º –Ω–æ–≤—ã–π –±–ª–æ–∫
    block = blockchain.mine_block(node_identifier)
    
    response = {
        'message': '–ù–æ–≤—ã–π –±–ª–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω!',
        'index': block.index,
        'transactions': block.transactions,
        'proof': block.proof,
        'previous_hash': block.previous_hash,
        'hash': block.compute_hash()
    }
    
    return jsonify(response), 200


@app.route('/transactions/new', methods=['POST'])
def new_transaction():
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"""
    values = request.get_json()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π
    required = ['sender', 'recipient', 'amount']
    if not all(k in values for k in required):
        return '–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è', 400
    
    # –°–æ–∑–¥–∞—ë–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    index = blockchain.new_transaction(
        values['sender'],
        values['recipient'],
        values['amount']
    )
    
    response = {'message': f'–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–ª–æ–∫ {index}'}
    return jsonify(response), 201


@app.route('/chain', methods=['GET'])
def full_chain():
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—É—é —Ü–µ–ø—å"""
    response = {
        'chain': blockchain.to_dict(),
        'length': len(blockchain.chain)
    }
    return jsonify(response), 200


@app.route('/nodes/register', methods=['POST'])
def register_nodes():
    """–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ —É–∑–ª—ã"""
    values = request.get_json()
    nodes = values.get('nodes')
    
    if nodes is None:
        return "–û—à–∏–±–∫–∞: —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ –ø—É—Å—Ç", 400
    
    for node in nodes:
        blockchain.register_node(node)
    
    response = {
        'message': '–ù–æ–≤—ã–µ —É–∑–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã',
        'total_nodes': list(blockchain.nodes)
    }
    return jsonify(response), 201


@app.route('/nodes/resolve', methods=['GET'])
def consensus():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞"""
    replaced = blockchain.resolve_conflicts()
    
    if replaced:
        response = {
            'message': '–ù–∞—à–∞ —Ü–µ–ø—å –∑–∞–º–µ–Ω–µ–Ω–∞',
            'new_chain': blockchain.to_dict()
        }
    else:
        response = {
            'message': '–ù–∞—à–∞ —Ü–µ–ø—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∞',
            'chain': blockchain.to_dict()
        }
    
    return jsonify(response), 200


@app.route('/balance/<address>', methods=['GET'])
def get_balance(address):
    """–ü–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å –∞–¥—Ä–µ—Å–∞"""
    balance = blockchain.get_balance(address)
    
    response = {
        'address': address,
        'balance': balance
    }
    return jsonify(response), 200


@app.route('/', methods=['GET'])
def index():
    """–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"""
    return jsonify({
        'node_id': node_identifier,
        'endpoints': {
            'mine': '/mine - –ú–∞–π–Ω–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞',
            'new_transaction': '/transactions/new - –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é',
            'chain': '/chain - –ü–æ–ª—É—á–∏—Ç—å –≤—Å—é —Ü–µ–ø—å',
            'register': '/nodes/register - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É–∑–ª—ã',
            'consensus': '/nodes/resolve - –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å',
            'balance': '/balance/<address> - –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å'
        }
    }), 200


# ============================================
# –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–´
# ============================================

def demo():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –±–ª–æ–∫—á–µ–π–Ω–∞"""
    print("\n" + "üöÄ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø BLOCKCHAIN " + "\n")
    
    # –°–æ–∑–¥–∞—ë–º –±–ª–æ–∫—á–µ–π–Ω
    bc = Blockchain()
    
    print("\n1Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏...")
    bc.new_transaction("Alice", "Bob", 5.0)
    bc.new_transaction("Bob", "Charlie", 2.0)
    
    print("\n2Ô∏è‚É£ –ú–∞–π–Ω–∏–º –±–ª–æ–∫ 1...")
    bc.mine_block("Miner1")
    
    print("\n3Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º –µ—â—ë —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏...")
    bc.new_transaction("Charlie", "Alice", 1.0)
    bc.new_transaction("Alice", "Bob", 3.0)
    
    print("\n4Ô∏è‚É£ –ú–∞–π–Ω–∏–º –±–ª–æ–∫ 2...")
    bc.mine_block("Miner2")
    
    print("\n5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å—ã...")
    print(f"–ë–∞–ª–∞–Ω—Å Alice: {bc.get_balance('Alice')} BTC")
    print(f"–ë–∞–ª–∞–Ω—Å Bob: {bc.get_balance('Bob')} BTC")
    print(f"–ë–∞–ª–∞–Ω—Å Charlie: {bc.get_balance('Charlie')} BTC")
    print(f"–ë–∞–ª–∞–Ω—Å Miner1: {bc.get_balance('Miner1')} BTC")
    print(f"–ë–∞–ª–∞–Ω—Å Miner2: {bc.get_balance('Miner2')} BTC")
    
    print("\n6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ü–µ–ø–∏...")
    is_valid = bc.is_valid_chain(bc.chain)
    print(f"–¶–µ–ø—å –≤–∞–ª–∏–¥–Ω–∞: {is_valid}")
    
    print("\n7Ô∏è‚É£ –í—ã–≤–æ–¥–∏–º –≤—Å—é —Ü–µ–ø—å...")
    bc.print_chain()
    
    print("\n8Ô∏è‚É£ –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–¥–µ–ª–∫–∏ –±–ª–æ–∫–∞...")
    # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–º–µ–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –±–ª–æ–∫–µ 1
    bc.chain[1].transactions[0]['amount'] = 1000.0
    print("–ò–∑–º–µ–Ω–∏–ª–∏ —Å—É–º–º—É –ø–µ—Ä–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ 1000 BTC")
    
    print("\n9Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –ø–æ–¥–¥–µ–ª–∫–∏...")
    is_valid = bc.is_valid_chain(bc.chain)
    print(f"–¶–µ–ø—å –≤–∞–ª–∏–¥–Ω–∞: {is_valid}")
    print("‚ùå –¶–µ–ø—å —Å—Ç–∞–ª–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π! –ü–æ–¥–¥–µ–ª–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞!")


# ============================================
# –ó–ê–ü–£–°–ö
# ============================================

if __name__ == '__main__':
    import sys
    
    if len(sys.argv) > 1 and sys.argv[1] == 'demo':
        # –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        demo()
    else:
        # –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞
        port = 5000
        if len(sys.argv) > 1:
            port = int(sys.argv[1])
        
        print(f"\nüöÄ –ó–∞–ø—É—Å–∫ Blockchain —É–∑–ª–∞ –Ω–∞ –ø–æ—Ä—Ç—É {port}")
        print(f"üìç Node ID: {node_identifier}\n")
        app.run(host='0.0.0.0', port=port)
````